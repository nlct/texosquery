% arara: xetex: {shell: on}

\input texosquery

\texosquerydefpattern{\DTpattern}{\%2d/\%2M/\%4y \%2H:\%2m:\%2s \%2Z}

Pattern: {\tt \DTpattern}

\TeXOSQueryDateTime{\datetimedata}

\ifx\datetimedata\empty
 Query Failed!
\else
 \expandafter\texosqueryfmtdatetime\expandafter\DTpattern\datetimedata
\fi

\texosquerydefpattern{\numpattern}{%
 \numfmt{\decfmt{\#\,\#\#\#\,\#\#\#\,\#\#\0}{\0\#\#\#\#\#\#\#\#\#}}}

\texosquerydefpattern{\numnzpattern}{%
 \numfmt{\decfmt{\#\,\#\#\#\,\#\#\#\,\#\#\0}{\#\#\#\#\#\#\#\#\#\#}}}

\texosquerydefpattern{\sinumpattern}{%
 \sinumfmt
 {\decfmt{\#\,\#\#\#\,\#\#\#\,\#\#\0}{\0\#\#\#\#\#\#\#\#\#}}%
 {\-\#\#\#\#\#\#\#\#\0\0}%
}

\texosquerydefpattern{\intpattern}{%
 \numfmt{\#\,\#\#\#\,\#\#\#\,\#\#\0}}

\texosquerydefpattern{\curpattern}{%
 \pmnumfmt
 {\pcur{\decfmt{\#\,\#\#\#\,\#\#\#\,\#\#\0}{\0\0\#\#\#\#\#\#\#\#}}{}}%
 {\pcur{\decfmt{\#\,\#\#\#\,\#\#\#\,\#\#\0}{\0\0\#\#\#\#\#\#\#\#}}{\-}}}

\texosquerydefpattern{\pcpattern}{%
 \numfmt{\spct{\#\,\#\#\#\,\#\#\#\,\#\#\0}{}}}

Numeric patterns.

\def\testpattern#1#2#3#4{%
  Testing {\tt #2.#3E#4}:
  \texosqueryfmtnumber{#1}{#2}{#3}{#4}
}

{\tt \numpattern}

\testpattern{\numpattern}{123}{4567}{2}

\testpattern{\numpattern}{-123}{4567}{0}

\testpattern{\numpattern}{-123}{4567}{-4}

\testpattern{\numpattern}{+1}{234567}{-3}

\testpattern{\numpattern}{1234567}{0}{0}

\testpattern{\numpattern}{0}{0}{0}

{\tt \numnzpattern}

\testpattern{\numnzpattern}{123}{4567}{2}

\testpattern{\numnzpattern}{-123}{4567}{0}

\testpattern{\numnzpattern}{-123}{4567}{-4}

\testpattern{\numnzpattern}{+1}{234567}{-3}

\testpattern{\numnzpattern}{1234567}{0}{0}

\testpattern{\numnzpattern}{0}{0}{0}

{\tt \sinumpattern}

\testpattern{\sinumpattern}{1}{234567}{-3}

\testpattern{\sinumpattern}{1}{234567}{4}

\testpattern{\sinumpattern}{-1}{234567}{2}

\testpattern{\sinumpattern}{1}{234567}{+890}

\testpattern{\sinumpattern}{0}{0}{0}

{\tt \intpattern}

\testpattern{\intpattern}{123}{4567}{2}

\testpattern{\intpattern}{-123}{4567}{0}

\testpattern{\intpattern}{0}{0}{0}

{\tt \curpattern}

\testpattern{\curpattern}{12345}{6}{0}

\testpattern{\curpattern}{12345678}{0}{0}

\testpattern{\curpattern}{-12345678}{0}{0}

\testpattern{\curpattern}{0}{0}{0}

{\tt \pcpattern}

\testpattern{\pcpattern}{1}{23}{0}

\testpattern{\pcpattern}{-0}{56}{0}

\testpattern{\pcpattern}{0}{0}{0}

\bye
